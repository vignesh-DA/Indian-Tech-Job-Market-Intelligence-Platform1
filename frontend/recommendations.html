<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Recommendations - Tech Job Intelligence</title>
    <link rel="stylesheet" href="/assets/css/variables.css">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/components.css">
    <link rel="stylesheet" href="/assets/css/responsive.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <i class="fas fa-briefcase"></i>
                <span>Tech Job Intelligence</span>
            </div>
            
            <div class="navbar-right">
                <ul class="navbar-menu">
                    <li><a href="/" class="nav-link">Home</a></li>
                    <li><a href="/recommendations" class="nav-link active">Recommendations</a></li>
                    <li><a href="/dashboard" class="nav-link">Dashboard</a></li>
                    <li><a href="/saved-jobs" class="nav-link">Saved Jobs</a></li>
                </ul>
                
                <!-- Profile Icon -->
                <div class="nav-profile-item">
                    <div class="profile-wrapper" id="profileBtn" title="Profile">
                        <img id="profileImg" src="https://via.placeholder.com/32" alt="Profile" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
                    </div>
                    
                    <!-- Dropdown Menu -->
                    <div class="profile-dropdown" id="profileDropdown">
                        <div class="dropdown-header">
                            <img id="dropdownProfilePic" src="https://via.placeholder.com/40" alt="Profile" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                            <div class="dropdown-user-info">
                                <div class="dropdown-user-name" id="dropdownUserName">User</div>
                                <div class="dropdown-user-email" id="dropdownUserEmail">user@example.com</div>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </a>
                    </div>
                </div>
                
                <div class="navbar-toggle" id="navToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container" style="padding-top: var(--spacing-2xl); padding-bottom: var(--spacing-2xl);">
            <!-- Header Section -->
            <div style="background: linear-gradient(135deg, var(--primary-color), #6366f1); color: white; padding: var(--spacing-2xl); border-radius: var(--border-radius-lg); margin-bottom: var(--spacing-2xl);">
                <h1 style="margin-bottom: var(--spacing-sm); color: white;">ðŸŽ¯ AI-Powered Job Recommendations</h1>
                <p style="margin-bottom: var(--spacing-lg); opacity: 0.9;">Find your next job that matches your skills â€“ and learn what's missing</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--spacing-lg);">
                    <div style="text-align: center;">
                        <p style="font-size: var(--text-2xl); font-weight: bold; margin-bottom: 4px;" id="totalMatchesMetric">0</p>
                        <p style="font-size: var(--text-sm); opacity: 0.9;">Total Matches</p>
                    </div>
                    <div style="text-align: center;">
                        <p style="font-size: var(--text-2xl); font-weight: bold; margin-bottom: 4px;" id="avgMatchMetric">0%</p>
                        <p style="font-size: var(--text-sm); opacity: 0.9;">Avg. Match</p>
                    </div>
                    <div style="text-align: center;">
                        <p style="font-size: var(--text-2xl); font-weight: bold; margin-bottom: 4px;" id="companiesMetric">0</p>
                        <p style="font-size: var(--text-sm); opacity: 0.9;">Companies</p>
                    </div>
                    <div style="text-align: center;">
                        <p style="font-size: var(--text-2xl); font-weight: bold; margin-bottom: 4px;" id="locationsMetric">0</p>
                        <p style="font-size: var(--text-sm); opacity: 0.9;">Locations</p>
                    </div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 280px 1fr; gap: var(--spacing-2xl); margin-bottom: var(--spacing-2xl);">
                <!-- Sidebar - Profile Form -->
                <div class="card" style="height: fit-content;">
                    <div class="card-header">
                        <h3 style="margin: 0;">Your Profile</h3>
                    </div>
                    <div class="card-body">
                        <form id="profileForm">
                            <!-- Role -->
                            <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                                <label class="form-label" style="display: flex; align-items: center; gap: 6px; margin-bottom: var(--spacing-sm);">
                                    <i class="fas fa-briefcase" style="color: var(--primary-color);"></i>
                                    <span>Job Role</span>
                                </label>
                                <select id="roleSelect" class="form-select" required style="font-size: 13px;">
                                    <option value="">Select a role...</option>
                                </select>
                            </div>

                            <!-- Experience -->
                            <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                                <label class="form-label" style="display: flex; align-items: center; gap: 6px; margin-bottom: var(--spacing-sm);">
                                    <i class="fas fa-chart-line" style="color: var(--primary-color);"></i>
                                    <span>Experience</span>
                                </label>
                                <select id="experienceSelect" class="form-select" required style="font-size: 13px;">
                                    <option value="">Select experience...</option>
                                </select>
                            </div>

                            <!-- Location -->
                            <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                                <label class="form-label" style="display: flex; align-items: center; gap: 6px; margin-bottom: var(--spacing-sm);">
                                    <i class="fas fa-map-marker-alt" style="color: var(--primary-color);"></i>
                                    <span>Location</span>
                                </label>
                                <select id="locationSelect" class="form-select" required style="font-size: 13px;">
                                    <option value="">Select location...</option>
                                </select>
                            </div>

                            <!-- Skills -->
                            <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                                <label class="form-label" style="display: flex; align-items: center; gap: 6px; margin-bottom: var(--spacing-sm);">
                                    <i class="fas fa-code" style="color: var(--primary-color);"></i>
                                    <span>Skills</span>
                                </label>
                                <div style="display: grid; grid-template-columns: 1fr auto; gap: var(--spacing-sm); margin-bottom: var(--spacing-md);">
                                    <input type="text" id="skillInput" class="form-input" placeholder="e.g. React, Python" style="font-size: 13px;">
                                    <button type="button" id="addSkillBtn" class="btn btn-secondary" style="padding: 8px 16px; font-size: 13px; white-space: nowrap;">
                                        <i class="fas fa-plus"></i> Add
                                    </button>
                                </div>
                                <div id="skillsTags" style="display: flex; flex-wrap: wrap; gap: var(--spacing-sm);"></div>
                            </div>

                            <!-- Submit and Clear Buttons -->
                            <div style="display: flex; flex-direction: column; gap: var(--spacing-md);">
                                <button type="submit" class="btn btn-primary" style="width: 100%; background: linear-gradient(135deg, var(--primary-color), #6366f1);">
                                    <i class="fas fa-wand-magic-sparkles"></i> Get Recommendations
                                </button>
                                <button type="button" id="clearFormBtn" class="btn btn-secondary" style="width: 100%;">
                                    <i class="fas fa-redo"></i> Clear
                                </button>
                            </div>
                        </form>

                        <!-- Smart Filters -->
                        <div style="margin-top: var(--spacing-xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-color);">
                            <h4 style="margin-bottom: var(--spacing-md); display: flex; align-items: center; gap: 6px;">
                                <i class="fas fa-sliders-h" style="color: var(--primary-color);"></i>
                                Smart Filters
                            </h4>
                            
                            <!-- Match Score Filter -->
                            <div style="margin-bottom: var(--spacing-lg);">
                                <label class="form-label" style="font-size: 13px;">Match Score</label>
                                <input type="range" id="matchScoreFilter" min="0" max="100" value="0" class="form-input" style="padding: 4px; cursor: pointer;">
                                <p style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">
                                    <span id="matchScoreValue">0</span>% and above
                                </p>
                            </div>

                            <!-- Location Filter -->
                            <div style="margin-bottom: var(--spacing-md);">
                                <label class="form-label" style="font-size: 13px;">
                                    <input type="checkbox" id="locationMatchFilter" style="margin-right: 6px;">
                                    Location Match Only
                                </label>
                            </div>

                            <!-- Skills Match Filter -->
                            <div>
                                <label class="form-label" style="font-size: 13px;">
                                    <input type="checkbox" id="skillsMatchFilter" style="margin-right: 6px;">
                                    Skills Match Only
                                </label>
                            </div>

                            <!-- Number of Recommendations -->
                            <div style="margin-top: var(--spacing-xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-color);">
                                <label class="form-label" style="display: flex; align-items: center; gap: 6px; margin-bottom: var(--spacing-md);">
                                    <i class="fas fa-list-ol" style="color: var(--primary-color);"></i>
                                    <span>Max Recommendations</span>
                                </label>
                                <input type="range" id="maxRecommendationsSlider" min="1" max="25" value="10" class="form-input" style="padding: 4px; cursor: pointer;">
                                <p style="font-size: 12px; color: var(--text-secondary); margin-top: 4px; text-align: center;">
                                    Show up to <strong id="maxRecommendationsValue">10</strong> jobs
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Content - Job Cards -->
                <div>
                    <div id="recommendationsContainer"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Tech Job Intelligence</h4>
                    <p>Your AI-powered job search assistant for the Indian tech market, helping you understand why a job fits you â€“ not just showing listings.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/recommendations">Recommendations</a></li>
                        <li><a href="/dashboard">Dashboard</a></li>
                        <li><a href="/saved-jobs">Saved Jobs</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>About Tech Job Intelligence</h4>
                    <p style="margin-bottom: var(--spacing-md); color: var(--text-secondary);">Tech Job Intelligence helps you make smarter career decisions using AI-powered job matching, skill-gap analysis, and market insights.</p>
                    <ul style="list-style: disc; padding-left: 20px;">
                        <li>Personalized job recommendations</li>
                        <li>Explainable match scores</li>
                        <li>Skill improvement guidance</li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- Floating Chatbot Button & Widget -->
    <div id="chatbot-button" class="chatbot-button" title="Chat with AI Assistant">
        <i class="fas fa-comments"></i>
    </div>

    <div id="chatbot-widget" class="chatbot-widget">
        <!-- Chatbot Header -->
        <div class="chatbot-header">
            <div class="chatbot-title">
                <i class="fas fa-robot"></i>
                <span>Career Assistant</span>
            </div>
            <button id="chatbot-close" class="chatbot-close" title="Close chat">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Chatbot Messages Area -->
        <div id="chatbot-messages" class="chatbot-messages">
            <div class="chatbot-message bot-message">
                <div class="message-content">
                    <p>ðŸ‘‹ Hi! I'm your Career Assistant. I can help you with:</p>
                    <ul style="margin-top: 8px; margin-left: 16px; font-size: 13px;">
                        <li>ðŸ’¼ Understanding job opportunities</li>
                        <li>ðŸŽ¯ Planning your career path</li>
                        <li>ðŸ“š Building missing skills</li>
                        <li>ðŸ“Š Market insights & salary info</li>
                    </ul>
                    <p style="margin-top: 8px; font-size: 12px; opacity: 0.8;">What can I help you with?</p>
                </div>
                <div class="message-time">Just now</div>
            </div>
        </div>

        <!-- Chatbot Input Area -->
        <div class="chatbot-input-area">
            <input 
                type="text" 
                id="chatbot-input" 
                class="chatbot-input" 
                placeholder="Type your question..." 
                autocomplete="off"
            >
            <button id="chatbot-send" class="chatbot-send" title="Send message">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/assets/js/config.js"></script>
    <script src="/assets/js/api.js"></script>
    <script src="/assets/js/utils.js"></script>
    <script src="/assets/js/main.js"></script>
    <script src="/assets/js/profile.js"></script>
    <script src="/assets/js/chatbot.js"></script>
    <script src="/assets/js/recommendations.js"></script>
    
    <script>
        // Initialize page
        document.addEventListener('DOMContentLoaded', async () => {
            // Check authentication and load profile
            await checkAuth();
            
            // Setup profile dropdown and logout
            setupProfileDropdown();
            setupLogout();
        });
    </script>
</body>
</html>
